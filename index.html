<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smart City KPI Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
        }

        optgroup {
            font-weight: bold;
            font-style: italic;
            color: #1a56db;
        }

        .chart-container {
            position: relative;
            margin: auto;
            height: 60vh;
            width: 80vw;
            max-width: 600px;
        }
    </style>
</head>

<body class="bg-gray-100 text-gray-800">
    <!-- Header ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà: ‡πÇ‡∏•‡πÇ‡∏Å‡πâ 250√ó45px + ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡πá‡∏ö -->
    <header class="bg-white border-b sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex items-center justify-between gap-4">
            <div class="flex items-center gap-3">
                <div class="relative block w-[250px] h-[45px] overflow-hidden">
                    <!-- ‡πÉ‡∏™‡πà‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ 250x45px) -->
                    <img src="https://raw.githubusercontent.com/belloflufyb/my-web/main/logo.png" alt="Smart City Logo"
                        class="w-[250px] h-[45px] object-contain" />
                </div>
                <h1 class="text-xl md:text-2xl font-bold text-gray-800">
                    ‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ó‡∏∏‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á</h1>
            </div>
            <div class="hidden md:flex items-center gap-2 text-sm text-gray-500">
                <span class="px-2 py-1 bg-gray-100 rounded-md">Smart & Livable Cities</span>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto p-4 md:p-8 space-y-10">
        <!-- ===== Section A: CSV-based (‡πÄ‡∏£‡∏î‡∏≤‡∏£‡πå 1 ‡πÄ‡∏°‡∏∑‡∏≠‡∏á + ‡∏ö‡∏≤‡∏£‡πå 1 KPI) ===== -->
        <section id="sectionA" class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
            <h2 class="text-2xl md:text-3xl font-bold text-gray-700 mb-2 text-center">üìä
                ‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ó‡∏∏‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á
            </h2>
            <p class="text-center text-gray-500 mb-8">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏• </p>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Left Column: Radar Chart -->
                <div class="bg-gray-50 p-4 rounded-xl">
                    <h3 class="text-lg font-bold text-center mb-4">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û (Radar Chart)</h3>
                    <div class="mb-4">
                        <label for="municipality-selector-a"
                            class="block mb-2 text-sm font-medium text-gray-900">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•:</label>
                        <select id="municipality-selector-a"
                            class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"></select>
                    </div>
                    <div class="w-full h-[50vh]"><canvas id="radarChartA"></canvas></div>
                </div>

                <!-- Right Column: Bar Chart -->
                <div class="bg-gray-50 p-4 rounded-xl">
                    <h3 class="text-lg font-bold text-center mb-4">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏£‡∏≤‡∏¢‡∏î‡πâ‡∏≤‡∏ô (Bar Chart)</h3>
                    <div class="mb-4">
                        <label for="kpi-selector-a" class="block mb-2 text-sm font-medium text-gray-900">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î
                            (KPI):</label>
                        <select id="kpi-selector-a"
                            class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"></select>
                    </div>
                    <div class="w-full h-[50vh]"><canvas id="barChartA"></canvas></div>
                </div>
            </div>
        </section>

        <!-- ===== Section B: Multi-city (‡∏™‡∏£‡∏∏‡∏õ/‡πÄ‡∏£‡∏î‡∏≤‡∏£‡πå‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡∏≠‡∏á/‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö) ===== -->
        <section id="sectionB" class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
            <header class="text-center mb-8">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡πÄ‡∏°‡∏∑‡∏≠‡∏á
                </h2>
                <p class="text-gray-600 mt-2">‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
                    1‚Äì5)</p>
            </header>

            <!-- Summary Section -->
            <div class="bg-white p-6 rounded-xl shadow-lg mb-8">
                <h3 class="text-2xl font-bold mb-4 text-center">‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î (KPI)</h3>
                <div class="flex justify-center mb-6">
                    <select id="summary-category-select"
                        class="w-full max-w-md p-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="GEO">‡∏î‡πâ‡∏≤‡∏ô‡∏†‡∏π‡∏°‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°</option>
                        <option value="INF">‡∏î‡πâ‡∏≤‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</option>
                        <option value="PPL">‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏Ñ‡∏ô</option>
                    </select>
                </div>
                <div id="summary-charts-container" class="grid grid-cols-1 lg:grid-cols-2 gap-x-6 gap-y-8"></div>
            </div>

            <!-- Single/Multi City Radar -->
            <div class="bg-white p-6 rounded-xl shadow-lg mb-8">
                <h3 class="text-2xl font-bold mb-4 text-center">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡∏≠‡∏á (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡∏≠‡∏á)</h3>
                <div id="city-selection-container"
                    class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2 mb-4 max-h-48 overflow-y-auto p-3 border rounded-lg bg-gray-50">
                </div>
                <div class="text-center mb-6">
                    <button id="clear-radar-selection-btn"
                        class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors">‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤</button>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                    <div class="chart-container mx-auto" style="max-width: 450px;">
                        <canvas id="radar-chart"></canvas>
                    </div>
                    <div id="kpi-details-wrapper">
                        <div id="kpi-details" class="max-h-[60vh] overflow-y-auto pr-2"></div>
                        <div id="kpi-details-placeholder"
                            class="hidden text-center text-gray-500 p-8 border-2 border-dashed rounded-lg">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 1
                            ‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î</div>
                    </div>
                </div>
            </div>

            <!-- KPI Comparison -->
            <div class="bg-white p-6 rounded-xl shadow-lg">
                <h3 class="text-2xl font-bold mb-4 text-center">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á (‡∏£‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î)</h3>
                <div id="comparison-city-selection-container"
                    class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2 mb-4 max-h-48 overflow-y-auto p-3 border rounded-lg bg-gray-50">
                </div>
                <div class="text-center mb-6">
                    <button id="clear-comparison-selection-btn"
                        class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors">‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤</button>
                </div>
                <div id="comparison-charts" class="space-y-6"></div>
            </div>
        </section>
    </main>

    <!-- ===== Scripts ‡∏£‡∏ß‡∏°‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏ß‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ===== -->
    <script>
        // ========== SECTION A (CSV) ==========
        (function sectionA() {
            const csvData = `Code,KPI Name_TH,Unit/Definition (short)_TH,Unit/Definition (short),Unit/Definition (short)_TH,‡∏•‡∏≥‡∏õ‡∏≤‡∏á,‡∏•‡∏≥‡∏û‡∏π‡∏ô,‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ,‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î,‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á,‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°,‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©,‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£,‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå,‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î,‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ,‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢,‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å,‡πÅ‡∏û‡∏£‡πà,‡∏ä‡∏∏‡∏°‡∏û‡∏£,‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå,‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞,‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä
GEO1,‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏°‡πÑ‡∏°‡πâ,‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞,% land area under canopy,‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞,15.82,21.43,3.25,4.68,18.63,42.56,45.77,71.56,8.14,6.57,16.4,28.79,0.47,8.22,42.88,16.54,30.29,20.1
GEO2,‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏™‡∏ß‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞/‡∏ô‡πâ‡∏≥,‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞,% pop ‚â§300m to park/blue,‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞,40.71,40.96,9.39,16.42,18.62,18.87,29.46,21.59,34.46,18.66,1.73,3.17,20.86,34.84,11.97,18,74.64,2.56
GEO3,‡∏Å‡∏≤‡∏£‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏ô‡πâ‡∏≥‡∏ó‡πà‡∏ß‡∏°,‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞,% pop in 100-yr floodplain,‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞,7.34,8.76,2.41,0.82,0,0,4.95,4.12,0,0,15.34,9.98,4.44,0.79,6.52,13.77,11.09,9.36
GEO4,‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏ô‡∏à‡∏±‡∏î,‡∏ß‡∏±‡∏ô/‡∏õ‡∏µ,# days > heat threshold/yr,‡∏ß‡∏±‡∏ô/‡∏õ‡∏µ,61,71,35,37,63,23,56,60,60,59,54,25,49,62,45,75,71,45
GEO5,‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏î‡∏¥‡∏ô‡∏ñ‡∏•‡πà‡∏°/‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß,‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞,% land in med-high class,‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞,0,0,0,0,1.07,0,0,0,0,0,0,0.46,0,0,0,0.78,4.1,0
GEO6,‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏ó‡πà‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ô‡πâ‡∏≥‡∏•‡∏∂‡∏Å,‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á,truck hours (typical),‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á,10.25,11.28,2.8,2.95,2.9,1.28,7.92,10.68,8.65,8.25,3.5,17.2,7.32,9.18,8.83,5.5,11.73,2.42
GEO7,‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏ñ‡∏∂‡∏á‡∏™‡∏ô‡∏≤‡∏°‡∏ö‡∏¥‡∏ô‡∏ô‡∏≤‡∏ô‡∏≤‡∏ä‡∏≤‡∏ï‡∏¥,‡∏Å‡∏°.,Distance to international airport,‡∏Å‡∏°.,101,30.7,8.2,17.1,70.6,64.9,69.8,228,88.3,122,90,191,353,202,167,222,5.1,18.9
GEO8,‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏°‡∏£‡∏î‡∏Å‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°,‡πÅ‡∏´‡πà‡∏á/‡∏´‡∏°‡∏∑‡πà‡∏ô‡∏Ñ‡∏ô,Cultural asset density,‡πÅ‡∏´‡πà‡∏á/‡∏´‡∏°‡∏∑‡πà‡∏ô‡∏Ñ‡∏ô,1.17,4.26,0,0,0,0,4.61,0.78,0,4.46,0,1.03,4.2,6.68,0,4.91,6.66,0
INF1,‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤,‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞,% households,‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞,75.9,93.5,99,99,90,95,95,99,95,95,95,99,95,95,95,95,85,95
INF2,‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞,‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞,% pop ‚â§500m frequent PT,‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞,3.19,11.11,0,0,4.29,0,4.26,2.3,2.64,2.19,2.02,0,2.73,5.09,1.23,1.07,0,0.6
INF3,‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ö‡∏ô‡∏ñ‡∏ô‡∏ô,‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏à‡∏≤‡∏Å‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏ /100k,Road fatalities/100k,‡∏Ñ‡∏ô/‡πÅ‡∏™‡∏ô‡∏Ñ‡∏ô,10,4,24,30,1,4,5,23,2,10,9,31,25,5,8,3,9,13
INF4,‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡∏µ‡∏¢‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•,‡πÄ‡∏ï‡∏µ‡∏¢‡∏á/1000 ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£,beds per 1000 pop,‡πÄ‡∏ï‡∏µ‡∏¢‡∏á/1000 ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£,711,440,665,87,372,220,853,907,570,881,700,821,1020,535,548,749,750,870
PPL1,‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏û‡∏∂‡πà‡∏á‡∏û‡∏¥‡∏á,(‡πÄ‡∏î‡πá‡∏Å+‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏)/‡∏ß‡∏±‡∏¢‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô,(0‚Äì14+65+)/15‚Äì64,(‡πÄ‡∏î‡πá‡∏Å+‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏)/‡∏ß‡∏±‡∏¢‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô,0.416,0.576,0.583,0.639,0.479,0.583,0.574,0,0,0.533,0.553,0.603,0.684,0.653,0.576,0.524,0.639
PPL2,‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏£‡πà‡∏ß‡∏°‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô,% ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏ß‡∏±‡∏¢‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô,% working-age in labour force, ‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏ß‡∏±‡∏¢‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô,63.8,73.1,70.8,70.8,65.5,74,71.9,69.3,74,76.9,70.1,73.2,74.5,69.6,73,77,71.2,65.5
PPL3,‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô,‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏à‡∏ö‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏õ‡∏•‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ,(% workforce with upper-sec+),% ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏ß‡∏±‡∏¢‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô,48,46,68,62,52,42,40,40,38,38,56,55,55,50,47,54,62,53
PPL4,‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡∏ô‡∏≠‡∏Å‡∏£‡∏∞‡∏ö‡∏ö,% ‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏á‡∏≤‡∏ô‡∏ô‡∏≠‡∏Å‡∏£‡∏∞‡∏ö‡∏ö,% workers informal,‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏á‡∏≤‡∏ô‡∏ô‡∏≠‡∏Å‡∏£‡∏∞‡∏ö‡∏ö,63.8,73.1,70.8,70.8,65.2,75.1,68.4,65.7,67.1,67.5,72.4,69.1,70.2,66.4,71.2,70.5,73.1,65.2
PPL5,‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏≤‡∏û‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô,GPP ‡∏ï‡πà‡∏≠‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô,currency per worker,GPP ‡∏ï‡πà‡∏≠‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô,180207,375595,93754,359977,194565,524002,93754,111338,117416,108788,499398,177117,223594,153831,250654,198213,250771,194565
PPL6,‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô,% ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏• / ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°,% working-age in labour force,% ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏ß‡∏±‡∏¢‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô,0.094167042,0.093531143,0.074715381,0.057617331,0.057617331,0.046543691,0.121434906,0.113938012,0.094132315,0.087913754,0.060719185,0.086343935,0.109406252,0.045699205,0.132231863,0.091891721,0.107692308,0.073204678`;

            let kpiDataA, municipalitiesA; let radarA, barA;

            function processDataA() {
                const lines = csvData.trim().split('\n');
                municipalitiesA = lines[0].split(',').slice(5);
                kpiDataA = lines.slice(1).map(line => {
                    const cols = line.split(',');
                    const values = cols.slice(5).map(v => parseFloat(v) || 0);
                    return { code: cols[0], name: cols[1], unit: cols[2].replace(/"/g, ''), values };
                });
                const lowerIsBetter = ['GEO3', 'GEO4', 'GEO5', 'GEO6', 'GEO7', 'INF3', 'PPL1', 'PPL4'];
                kpiDataA.forEach(k => {
                    const vals = k.values; const min = Math.min(...vals); const max = Math.max(...vals);
                    k.normalizedValues = vals.map(v => {
                        if (max === min) return 50; let n = ((v - min) / (max - min)) * 100; return lowerIsBetter.includes(k.code) ? 100 - n : n;
                    });
                });
            }

            function setupSelectorsA() {
                const muniSel = document.getElementById('municipality-selector-a');
                municipalitiesA.forEach((m, i) => { const opt = document.createElement('option'); opt.value = i; opt.textContent = m; muniSel.appendChild(opt); });

                const kpiSel = document.getElementById('kpi-selector-a');
                const categoryMap = { 'GEO': '‡∏†‡∏π‡∏°‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°', 'INF': '‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô', 'PPL': '‡∏î‡πâ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£' };
                const grouped = {};
                kpiDataA.forEach((k, i) => { const cat = k.code.replace(/[0-9]/g, ''); const name = categoryMap[cat]; if (name) { (grouped[name] ||= []).push({ ...k, idx: i }); } });
                for (const name in grouped) { const og = document.createElement('optgroup'); og.label = `--- ${name} ---`; grouped[name].forEach(k => { const o = document.createElement('option'); o.value = k.idx; o.textContent = k.name; og.appendChild(o); }); kpiSel.appendChild(og); }
            }

            function makeRadarA(idx) {
                const ctx = document.getElementById('radarChartA').getContext('2d');
                radarA?.destroy();
                radarA = new Chart(ctx, {
                    type: 'radar',
                    data: { labels: kpiDataA.map(k => k.code), datasets: [{ label: municipalitiesA[idx], data: kpiDataA.map(k => k.normalizedValues[idx]), originalData: kpiDataA.map(k => ({ value: k.values[idx], unit: k.unit, name: k.name })), fill: true, backgroundColor: 'rgba(54,162,235,0.2)', borderColor: 'rgb(54,162,235)', pointBackgroundColor: 'rgb(54,162,235)' }] },
                    options: { responsive: true, maintainAspectRatio: false, scales: { r: { suggestedMin: 0, suggestedMax: 100, pointLabels: { font: { size: 10 } }, ticks: { stepSize: 20 } } }, plugins: { legend: { position: 'top' }, tooltip: { callbacks: { label: (c) => { const o = c.dataset.originalData[c.dataIndex]; return `${o.name}: ${o.value.toLocaleString()} ${o.unit}`; } } } } }
                });
            }

            function makeBarA(kpiIdx) {
                const ctx = document.getElementById('barChartA').getContext('2d');
                const k = kpiDataA[kpiIdx];
                let combo = municipalitiesA.map((lab, i) => ({ label: lab, value: k.values[i] })).sort((a, b) => b.value - a.value);
                barA?.destroy();
                barA = new Chart(ctx, {
                    type: 'bar',
                    data: { labels: combo.map(d => d.label), datasets: [{ label: k.name, data: combo.map(d => d.value), backgroundColor: 'rgba(255,99,132,0.5)', borderColor: 'rgb(255,99,132)', borderWidth: 1, borderRadius: 4 }] },
                    options: { responsive: true, maintainAspectRatio: false, indexAxis: 'y', scales: { y: { ticks: { font: { size: 10 } } } }, plugins: { legend: { display: false }, title: { display: true, text: k.name }, tooltip: { callbacks: { label: (c) => `${c.parsed.x.toLocaleString()} ${k.unit}` } } } }
                });
            }

            document.addEventListener('DOMContentLoaded', () => {
                processDataA();
                setupSelectorsA();
                const mSel = document.getElementById('municipality-selector-a');
                const kSel = document.getElementById('kpi-selector-a');
                mSel.addEventListener('change', e => makeRadarA(e.target.value));
                kSel.addEventListener('change', e => makeBarA(e.target.value));
                makeRadarA(mSel.value || 0);
                makeBarA(kSel.value || 0);
            });
        })();

        // ========== SECTION B (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 1‚Äì5) ==========
        (function sectionB() {
            const kpiData = [
                { "Code": "GEO1", "KPI Name_TH": "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏°‡πÑ‡∏°‡πâ", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 1, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 2, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 1, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 1, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 1, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 3, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 3, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 4, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 1, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 1, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 1, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 2, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 1, "‡πÅ‡∏û‡∏£‡πà": 1, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 3, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 1, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 2, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 1 },
                { "Code": "GEO2", "KPI Name_TH": "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏™‡∏ß‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞/‡∏ô‡πâ‡∏≥", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 2, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 2, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 1, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 2, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 1, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 1, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 2, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 2, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 2, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 1, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 1, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 1, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 1, "‡πÅ‡∏û‡∏£‡πà": 2, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 1, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 1, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 4, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 1 },
                { "Code": "GEO3", "KPI Name_TH": "‡∏Å‡∏≤‡∏£‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏ô‡πâ‡∏≥‡∏ó‡πà‡∏ß‡∏°", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 5, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 5, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 5, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 5, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 5, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 5, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 5, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 5, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 5, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 5, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 5, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 5, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 5, "‡πÅ‡∏û‡∏£‡πà": 5, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 5, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 5, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 5, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 5 },
                { "Code": "GEO4", "KPI Name_TH": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏ô‡∏à‡∏±‡∏î", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 2, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 1, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 4, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 4, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 2, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 5, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 2, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 2, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 2, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 2, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 2, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 5, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 3, "‡πÅ‡∏û‡∏£‡πà": 2, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 3, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 1, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 1, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 3 },
                { "Code": "GEO5", "KPI Name_TH": "‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏î‡∏¥‡∏ô‡∏ñ‡∏•‡πà‡∏°/‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 1, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 1, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 1, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 1, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 1, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 1, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 1, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 1, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 1, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 1, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 1, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 1, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 1, "‡πÅ‡∏û‡∏£‡πà": 1, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 1, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 1, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 1, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 1 },
                { "Code": "GEO6", "KPI Name_TH": "‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏ó‡πà‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ô‡πâ‡∏≥‡∏•‡∏∂‡∏Å", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 3, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 2, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 5, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 5, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 5, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 5, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 3, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 3, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 3, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 3, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 5, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 1, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 4, "‡πÅ‡∏û‡∏£‡πà": 3, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 3, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 4, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 2, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 5 },
                { "Code": "GEO7", "KPI Name_TH": "‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏™‡∏ô‡∏≤‡∏°‡∏ö‡∏¥‡∏ô", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 3, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 4, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 5, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 5, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 4, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 3, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 3, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 1, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 2, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 3, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 2, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 1, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 1, "‡πÅ‡∏û‡∏£‡πà": 2, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 2, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 2, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 5, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 5 },
                { "Code": "GEO8", "KPI Name_TH": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏°‡∏£‡∏î‡∏Å‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 1, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 1, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 1, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 1, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 1, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 1, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 1, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 1, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 1, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 1, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 1, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 1, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 1, "‡πÅ‡∏û‡∏£‡πà": 1, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 1, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 1, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 1, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 1 },
                { "Code": "INF1", "KPI Name_TH": "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 4, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 5, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 5, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 5, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 5, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 5, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 5, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 5, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 5, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 5, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 5, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 5, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 5, "‡πÅ‡∏û‡∏£‡πà": 5, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 5, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 5, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 5, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 5 },
                { "Code": "INF2", "KPI Name_TH": "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 1, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 1, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 1, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 1, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 1, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 1, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 1, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 1, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 1, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 1, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 1, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 1, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 1, "‡πÅ‡∏û‡∏£‡πà": 1, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 1, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 1, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 1, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 1 },
                { "Code": "INF3", "KPI Name_TH": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ö‡∏ô‡∏ñ‡∏ô‡∏ô", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 4, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 5, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 2, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 1, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 5, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 5, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 5, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 2, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 5, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 4, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 4, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 1, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 1, "‡πÅ‡∏û‡∏£‡πà": 5, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 4, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 5, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 4, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 3 },
                { "Code": "INF4", "KPI Name_TH": "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡∏µ‡∏¢‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 4, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 2, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 2, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 1, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 3, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 2, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 2, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 3, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 2, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 3, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 2, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 3, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 4, "‡πÅ‡∏û‡∏£‡πà": 4, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 3, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 3, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 1, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 3 },
                { "Code": "PPL1", "KPI Name_TH": "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏û‡∏∂‡πà‡∏á‡∏û‡∏¥‡∏á", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 3, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 4, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 2, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 2, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 3, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 4, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 3, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 4, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 3, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 2, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 3, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 4, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 3, "‡πÅ‡∏û‡∏£‡πà": 4, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 3, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 2, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 5, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 3 },
                { "Code": "PPL2", "KPI Name_TH": "‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏£‡πà‡∏ß‡∏°‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 2, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 3, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 4, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 4, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 2, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 3, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 2, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 2, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 2, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 3, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 3, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 3, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 4, "‡πÅ‡∏û‡∏£‡πà": 2, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 3, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 4, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 1, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 3 },
                { "Code": "PPL3", "KPI Name_TH": "‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 4, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 4, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 5, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 5, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 3, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 4, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 3, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 4, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 3, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 4, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 4, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 5, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 5, "‡πÅ‡∏û‡∏£‡πà": 4, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 3, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 5, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 4, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 4 },
                { "Code": "PPL4", "KPI Name_TH": "‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡∏ô‡∏≠‡∏Å‡∏£‡∏∞‡∏ö‡∏ö", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 4, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 5, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 3, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 3, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 4, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 5, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 4, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 3, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 4, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 4, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 3, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 5, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 4, "‡πÅ‡∏û‡∏£‡πà": 5, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 4, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 3, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 5, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 4 },
                { "Code": "PPL5", "KPI Name_TH": "‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏≤‡∏û‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 3, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 4, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 3, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 3, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 4, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 4, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 3, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 4, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 3, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 3, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 4, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 4, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 3, "‡πÅ‡∏û‡∏£‡πà": 4, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 4, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 3, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 5, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 3 },
                { "Code": "PPL6", "KPI Name_TH": "‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô", "‡∏•‡∏≥‡∏õ‡∏≤‡∏á": 4, "‡∏•‡∏≥‡∏û‡∏π‡∏ô": 4, "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ": 5, "‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î": 5, "‡∏ó‡∏∏‡πà‡∏á‡∏™‡∏á": 3, "‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°": 4, "‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©": 3, "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": 3, "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå": 3, "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î": 4, "‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ": 4, "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢": 5, "‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å": 5, "‡πÅ‡∏û‡∏£‡πà": 4, "‡∏ä‡∏∏‡∏°‡∏û‡∏£": 3, "‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏ß‡∏£‡∏Ñ‡πå": 5, "‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞": 5, "‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä": 4 }
            ];

            const cityNames = Object.keys(kpiData[0]).filter(key => !["Code", "KPI Name_TH"].includes(key));
            const kpiDetailsContainer = document.getElementById('kpi-details');
            const kpiDetailsPlaceholder = document.getElementById('kpi-details-placeholder');
            const comparisonChartsContainer = document.getElementById('comparison-charts');
            const radarCtx = document.getElementById('radar-chart').getContext('2d');
            const citySelectionContainer = document.getElementById('city-selection-container');
            const comparisonCitySelectionContainer = document.getElementById('comparison-city-selection-container');
            const summaryCategorySelect = document.getElementById('summary-category-select');
            const summaryChartsContainer = document.getElementById('summary-charts-container');
            const clearRadarSelectionBtn = document.getElementById('clear-radar-selection-btn');
            const clearComparisonSelectionBtn = document.getElementById('clear-comparison-selection-btn');
            let radarChart;

            const chartColors = [
                'rgba(54, 162, 235, 1)', 'rgba(255, 99, 132, 1)', 'rgba(75, 192, 192, 1)',
                'rgba(255, 206, 86, 1)', 'rgba(153, 102, 255, 1)', 'rgba(255, 159, 64, 1)',
                'rgba(201, 203, 207, 1)', 'rgba(50, 205, 50, 1)', 'rgba(218, 112, 214, 1)',
                'rgba(0, 191, 255, 1)', 'rgba(255, 20, 147, 1)', 'rgba(255, 69, 0, 1)',
                'rgba(138, 43, 226, 1)', 'rgba(0, 255, 127, 1)', 'rgba(210, 105, 30, 1)',
                'rgba(127, 255, 0, 1)', 'rgba(106, 90, 205, 1)', 'rgba(255, 105, 180, 1)'
            ];

            function populateSelectors() {
                cityNames.forEach((city, index) => {
                    const radarCheckboxId = `radar-city-checkbox-${index}`;
                    const comparisonCheckboxId = `comparison-city-checkbox-${index}`;
                    const checkboxHTML = `
            <div class="flex items-center">
              <input id="${radarCheckboxId}" type="checkbox" value="${city}" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 radar-checkbox">
              <label for="${radarCheckboxId}" class="ml-2 text-sm font-medium text-gray-900">${city}</label>
            </div>`;
                    const comparisonCheckboxHTML = `
            <div class="flex items-center">
              <input id="${comparisonCheckboxId}" type="checkbox" value="${city}" class="w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 rounded focus:ring-indigo-500 comparison-checkbox">
              <label for="${comparisonCheckboxId}" class="ml-2 text-sm font-medium text-gray-900">${city}</label>
            </div>`;
                    citySelectionContainer.insertAdjacentHTML('beforeend', checkboxHTML);
                    comparisonCitySelectionContainer.insertAdjacentHTML('beforeend', comparisonCheckboxHTML);
                });
            }

            function getScoreColor(score) { if (score >= 4) return 'bg-green-100 text-green-800'; if (score >= 3) return 'bg-yellow-100 text-yellow-800'; if (score >= 2) return 'bg-orange-100 text-orange-800'; return 'bg-red-100 text-red-800'; }
            function getBarColor(score) { if (score >= 4) return 'rgba(74, 222, 128, 0.7)'; if (score >= 3) return 'rgba(250, 204, 21, 0.7)'; if (score >= 2) return 'rgba(251, 146, 60, 0.7)'; return 'rgba(239, 68, 68, 0.7)'; }

            function updateSummaryCharts() {
                const selectedCategory = summaryCategorySelect.value; summaryChartsContainer.innerHTML = '';
                const data = kpiData.filter(kpi => kpi.Code.startsWith(selectedCategory));
                data.forEach(kpi => {
                    const chartContainer = document.createElement('div');
                    chartContainer.className = 'border p-4 rounded-lg bg-gray-50';
                    chartContainer.innerHTML = `<h4 class="font-semibold text-center mb-2 text-sm">${kpi.Code}: ${kpi['KPI Name_TH']}</h4><div style="height: 450px;"><canvas></canvas></div>`;
                    summaryChartsContainer.appendChild(chartContainer);

                    const cityScores = cityNames.map(city => ({ city, score: kpi[city] })).sort((a, b) => b.score - a.score);
                    const sortedLabels = cityScores.map(item => item.city);
                    const sortedData = cityScores.map(item => item.score);
                    const backgroundColors = sortedData.map(score => getBarColor(score));

                    new Chart(chartContainer.querySelector('canvas').getContext('2d'), {
                        type: 'bar',
                        data: { labels: sortedLabels, datasets: [{ label: '‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô', data: sortedData, backgroundColor: backgroundColors }] },
                        options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, scales: { x: { beginAtZero: true, max: 5, ticks: { stepSize: 1 } } }, plugins: { legend: { display: false } } }
                    });
                });
            }

            function updateRadarDashboard() {
                const selectedCities = Array.from(document.querySelectorAll('.radar-checkbox:checked')).map(cb => cb.value);
                const datasets = selectedCities.map((city, index) => {
                    const color = chartColors[index % chartColors.length];
                    return { label: city, data: kpiData.map(kpi => kpi[city]), backgroundColor: color.replace('1)', '0.2)'), borderColor: color, borderWidth: 2, pointBackgroundColor: color };
                });

                radarChart?.destroy();
                radarChart = new Chart(radarCtx, {
                    type: 'radar',
                    data: { labels: kpiData.map(kpi => kpi.Code), datasets },
                    options: { responsive: true, maintainAspectRatio: false, scales: { r: { angleLines: { display: true }, suggestedMin: 0, suggestedMax: 5, pointLabels: { font: { size: 10 } }, ticks: { stepSize: 1 } } }, plugins: { legend: { position: 'top' }, tooltip: { callbacks: { label: (c) => `${c.dataset.label} - ${kpiData[c.dataIndex]['KPI Name_TH']}: ${c.formattedValue}` } } } }
                });

                if (selectedCities.length === 1) {
                    kpiDetailsContainer.style.display = 'block'; kpiDetailsPlaceholder.style.display = 'none';
                    const selectedCity = selectedCities[0]; kpiDetailsContainer.innerHTML = '';
                    kpiData.forEach(kpi => {
                        const score = kpi[selectedCity]; const colorClasses = getScoreColor(score);
                        kpiDetailsContainer.insertAdjacentHTML('beforeend', `<div class="p-3 rounded-lg flex justify-between items-center mb-2 ${colorClasses}"><div><p class="font-bold">${kpi.Code}</p><p class="text-sm">${kpi['KPI Name_TH']}</p></div><div class="text-2xl font-bold">${score}</div></div>`);
                    });
                } else {
                    kpiDetailsContainer.style.display = 'none'; kpiDetailsPlaceholder.style.display = 'block';
                }
            }

            function updateMultiCityComparison() {
                const selectedCities = Array.from(document.querySelectorAll('.comparison-checkbox:checked')).map(cb => cb.value);
                comparisonChartsContainer.innerHTML = '';
                if (selectedCities.length < 2) {
                    comparisonChartsContainer.innerHTML = '<p class="text-center text-gray-600">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö</p>';
                    return;
                }
                kpiData.forEach(kpi => {
                    const container = document.createElement('div');
                    container.className = 'p-4 border rounded-lg bg-gray-50';
                    container.innerHTML = `<h4 class="font-bold text-center mb-2">${kpi.Code}: ${kpi['KPI Name_TH']}</h4><div style="height: ${selectedCities.length * 30 + 40}px;"><canvas></canvas></div>`;
                    comparisonChartsContainer.appendChild(container);

                    const datasets = [{ label: '‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô', data: selectedCities.map(city => kpi[city]), backgroundColor: selectedCities.map((_, index) => chartColors[index % chartColors.length].replace('1)', '0.7)')) }];

                    new Chart(container.querySelector('canvas').getContext('2d'), {
                        type: 'bar',
                        data: { labels: selectedCities, datasets },
                        options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, scales: { x: { beginAtZero: true, max: 5, ticks: { stepSize: 1 } } }, plugins: { legend: { display: false } } }
                    });
                });
            }

            // Events & Init
            summaryCategorySelect.addEventListener('change', updateSummaryCharts);
            citySelectionContainer.addEventListener('change', updateRadarDashboard);
            comparisonCitySelectionContainer.addEventListener('change', updateMultiCityComparison);
            clearRadarSelectionBtn.addEventListener('click', () => { document.querySelectorAll('.radar-checkbox:checked').forEach(cb => cb.checked = false); updateRadarDashboard(); });
            clearComparisonSelectionBtn.addEventListener('click', () => { document.querySelectorAll('.comparison-checkbox:checked').forEach(cb => cb.checked = false); updateMultiCityComparison(); });

            document.addEventListener('DOMContentLoaded', () => {
                populateSelectors();
                updateSummaryCharts();
                const firstRadarCheckbox = document.querySelector('.radar-checkbox'); if (firstRadarCheckbox) firstRadarCheckbox.checked = true;
                const comparisonCheckboxes = document.querySelectorAll('.comparison-checkbox'); if (comparisonCheckboxes.length > 1) { comparisonCheckboxes[0].checked = true; comparisonCheckboxes[1].checked = true; }
                updateRadarDashboard();
                updateMultiCityComparison();
            });
        })();
    </script>
</body>

</html>